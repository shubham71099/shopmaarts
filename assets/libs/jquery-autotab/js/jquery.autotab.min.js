/**
 * Autotab - jQuery plugin 1.5.1
 * https://github.com/Mathachew/jquery-autotab
 * 
 * Copyright (c) 2013 Matthew Miller
 * 
 * Licensed under the MIT licensing:
 *   http://www.opensource.org/licenses/mit-license.php
 */

(function(e){var l=navigator.platform,d={tabPause:800,focusChange:null,iOS:"iPad"===l||"iPhone"===l||"iPod"===l,firefox:"undefined"!==typeof InstallTrigger},n=function(b,c){if(null!==c&&"undefined"!==typeof c)for(var a in c)e(b).data("autotab-"+a,c[a])},k=function(b){var c={format:"all",loaded:!1,disabled:!1,pattern:null,uppercase:!1,lowercase:!1,nospace:!1,maxlength:2147483647,target:null,previous:null,trigger:null},a;for(a in c)c[a]=e(b).data("autotab-"+a)||c[a];c.loaded||(null!==c.trigger&&"string"===
typeof c.trigger&&(c.trigger=c.trigger.toString()),n(b,c));return c};e.autotab={next:function(){var b=e(document.activeElement);b.length&&b.trigger("autotab-next")},previous:function(){var b=e(document.activeElement);b.length&&b.trigger("autotab-previous")}};e.fn.autotab=function(b,c){if(!this.length)return this;if("filter"==b){if("string"===typeof c||"function"===typeof c)c={format:c};for(var a=0,d=this.length;a<d;a++){var f=k(this[a]),g=c;g.target=f.target;g.previous=f.previous;e.extend(f,g);n(this[a],
f)}}else if("remove"==b||"destroy"==b||"disable"==b)for(a=0,d=this.length;a<d;a++)f=k(this[a]),f.disabled=!0,n(this[a],f);else if("restore"==b||"enable"==b)for(a=0,d=this.length;a<d;a++)f=k(this[a]),f.disabled=!1,n(this[a],f);else if(null===b||"undefined"===typeof b?c={}:"string"===typeof b||"function"===typeof b?c={format:b}:"object"===typeof b&&(c=b),1<this.length)for(a=0,d=this.length;a<d;a++){var f=a+1,r=a-1,g=c;0<a&&f<d?(g.target=this[f],g.previous=this[r]):0<a?(g.target=null,g.previous=this[r]):
(g.target=this[f],g.previous=null);s(this[a],g)}else s(this[0],c);return this};var p=function(b,c,a){if("function"===typeof a.format)return a.format(c,b);b=null;switch(a.format){case "text":b=RegExp("[0-9]+","g");break;case "alpha":b=RegExp("[^a-zA-Z]+","g");break;case "number":case "numeric":b=RegExp("[^0-9]+","g");break;case "alphanumeric":b=RegExp("[^0-9a-zA-Z]+","g");break;case "hex":case "hexadecimal":b=RegExp("[^0-9A-Fa-f]+","g");break;case "custom":b=RegExp(a.pattern,"g")}null!==b&&(c=c.replace(b,
""));a.nospace&&(b=RegExp("[ ]+","g"),c=c.replace(b,""));a.uppercase&&(c=c.toUpperCase());a.lowercase&&(c=c.toLowerCase());return c},s=function(b,c){var a=k(b);a.disabled&&(a.disabled=!1,a.target=null,a.previous=null);e.extend(a,c);"string"!==typeof a.target&&a.target instanceof jQuery||(a.target=e(a.target));"string"!==typeof a.previous&&a.previous instanceof jQuery||(a.previous=e(a.previous));var l=b.maxLength;2147483647==a.maxlength&&2147483647!=l?a.maxlength=l:0<a.maxlength?b.maxLength=a.maxlength:
a.target=null;d.loaded?n(b,a):(a.loaded=!0,n(b,a),e(b).on("autotab-next",function(a,b){var c=this;setTimeout(function(){b||(b=k(c));b.disabled||!b.target.length||d.iOS||(b.target.focus().select(),d.focusChange=new Date)},1)}).on("autotab-previous",function(a,b){var c=this;setTimeout(function(){b||(b=k(c));var a=b.previous;if(!b.disabled&&a.length){var f=a.val();a.focus().val(f.substring(0,f.length-1));d.focusChange=null}},1)}).on("keydown",function(a){var b=k(this);if(!b||b.disabled)return!0;var c=
a.which||a.charCode;if(8==c&&0===this.value.length&&b.previous.length)e(this).trigger("autotab-previous",b);else if(9==c&&null!==d.focusChange)if(a.shiftKey)d.focusChange=null;else if((new Date).getTime()-d.focusChange.getTime()<d.tabPause)return d.focusChange=null,!1}).on("keypress",function(a){var b=k(this);if(!b||b.disabled||d.firefox&&0===a.charCode||a.ctrlKey||a.altKey)return!0;var c=String.fromCharCode(a.which||a.keyCode);if(null!==b.trigger&&0<=b.trigger.indexOf(c))return null!==d.focusChange&&
(new Date).getTime()-d.focusChange.getTime()<d.tabPause?d.focusChange=null:e(this).trigger("autotab-next",b),!1;d.focusChange=null;a=document.selection&&document.selection.createRange?!0:0<a.charCode;var q=!1,c=p(this,c,b);if(a&&(null===c||""===c))return!1;if(a&&this.value.length<=this.maxLength){var m,h;"number"===typeof this.selectionStart&&"number"===typeof this.selectionEnd?(m=this.selectionStart,h=this.selectionEnd):document.selection&&document.selection.createRange&&(c=document.selection.createRange(),
m=this.createTextRange(),h=this.createTextRange(),a=c.getBookmark(),m.moveToBookmark(a),h.setEndPoint("EndToStart",m),m=h.text.length,h=m+c.text.length);if((0!==m||h!=this.value.length)&&this.value.length==this.maxLength)return e(this).trigger("autotab-next",b),!1;q=!0}q&&this.value.length+1==b.maxlength&&e(this).trigger("autotab-next",b);return q}).on("paste",function(a){var b=k(this);if(!b)return!0;this.maxLength=2147483647;(function(a,c){setTimeout(function(){var f=-1,h=document.createElement("input");
h.type="hidden";h.value=a.value.toLowerCase();a.maxLength=c.maxlength;a.value=p(a,a.value,c).substr(0,c.maxlength);var l=function(a,b){if(a){for(var c=0,g=b.length;c<g;c++)f=h.value.indexOf(b.charAt(c),f)+1;c=k(a);g=h.value.substr(f);(g=p(a,g,c).substr(0,c.maxlength))?(a.value=g,g.length==c.maxlength&&(e(a).trigger("autotab-next",c),d.iOS||l(c.target[0],g))):a.value=""}};a.value.length==c.maxlength&&(e(a).trigger("autotab-next",b),d.iOS||l(c.target[0],a.value.toLowerCase()))},1)})(this,b)}))};e.fn.autotab_magic=
function(b){e(this).autotab()};e.fn.autotab_filter=function(b){var c={};"string"===typeof b||"function"===typeof b?c.format=b:e.extend(c,b);e(this).autotab("filter",c)}})(jQuery);
